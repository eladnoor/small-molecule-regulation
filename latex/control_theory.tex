\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{pgfplots}
\usepackage[square,numbers]{natbib}
\pgfplotsset{compat=1.13}
\newcommand{\ratelaw}{\theta(\mathbf{s},\mathbf{p})}
\renewcommand*\rmdefault{bch}


\begin{document}
\section{Control Theory}
\subsection{What is elasticity?}
Metabolic Control Analysis \cite{Fell1996-be} is a mathematical framework that is widely applied to dynamic systems such as metabolic networks. In particular, it defines local properties called elasticities that can be used to quantify how the control of some variables, such as fluxes, depend on other features of the system. \emph{Scaled elasticity} is defined as the infinitesimal response of a single flux ($v$) to one of the parameters ($a$), using a partial derivative of the log-scaled functions:
\begin{eqnarray}
    \epsilon_a^v \equiv \frac{\partial \ln(v)}{\partial \ln(a)} = \frac{\partial v}{\partial a} ~ \frac{a}{v}
\end{eqnarray}

\subsection{Single-substrate Control}
Consider an enzyme-catalyzed reaction, described by a one-substrate irreversible Michaelis-Menten kinetic rate law:
\begin{eqnarray}
    v &=& V^+ ~ \frac{s}{K_M + s}
\end{eqnarray}
where $s$ is the substrate concentrations (in units of molar), and $K_M$ is the Michaelis-Menten coefficient (also in molar).

The scaled elasticity for $s$ is given by:
\begin{eqnarray}
    \epsilon_s^v &=& \frac{\partial v}{\partial s} ~ \frac{s}{v} = V^+ ~ \frac{K_M + s - s}{(K_M + s)^2} ~ \frac{s}{v} \nonumber \\
    &=& \frac{K_M}{(K_M + s)^2} ~ (K_M + s) = \frac{K_M}{K_M + s} = 1 - \frac{s}{K_M + s}\label{eq:eps_s_v_irr}
\end{eqnarray}

As shown in \cite{Noor2013-vv}, this formula for substrate elasticity can be generalized to reversible Michaelis-Menten reactions, where the saturation term is separated from the thermodynamic term:
\begin{eqnarray}
    v &=& V^+ \cdot \kappa \cdot \gamma \\
    \kappa &\equiv& \frac{s/K_S}{1 + s/K_S + p/K_P} \\
    \gamma &\equiv& 1 - \frac{p/s}{K_{eq}'}
\end{eqnarray}
where $p$ is the product concentration, $K_S$ and $K_P$ are the Michaelis-Menten constants for the substrate and product, and $K_{eq}'$ is the apparent equilibrium constant. In this case, the elasticity of the substrate and product are:
\begin{eqnarray}
    \epsilon_s^v &=& \gamma^{-1} - \kappa
\end{eqnarray}
which converges to equation \ref{eq:eps_s_v_irr} as $p \rightarrow 0$.

\subsection{Regulatory Effectors}
As far as we know, previous publications have not dealt specifically with elasticities associated with small-molecule effectors such as allosteric regulators. Without loss of generality, we will keep the separable form of the rate law
\[v = V^+ \cdot \kappa \cdot \gamma \cdot \theta(x)\]
where we add a multiplicative term $\theta(x)$ that will represent the decrease of activity due to the small-molecule regulation ($x$). As long as $\theta(x)$ is the only term affected by $x$, i.e. $\frac{\partial \kappa}{\partial x} = \frac{\partial \gamma}{\partial x} = 0$, the exact forms of $\kappa$ and $\gamma$ are irrelevant.

\subsubsection{Activation}
First, consider a cooperative \cite{Barcroft1910-rx, Monod1965-dq} activator with Hill coefficient $h$ and activation coefficient $K_A$:
\begin{eqnarray}
    \theta &=& \frac{a^h}{K_A^h + a^h}~.
\end{eqnarray}
The elasticity with respect to the activator concentration $x$ will thus be:
\begin{eqnarray}
    \epsilon_a^v &=& \frac{\partial v}{\partial a} ~ \frac{a}{v} = V^+ ~ \kappa ~ \gamma ~ \frac{h~a^{h-1} (K_A^h + a^h) - h~a^{h-1} a^h}{(K_A^h + a^h)^2}~\frac{a}{v} \nonumber \\
    &=& h~\frac{K_A^h}{K_A^h + a^h} = h (1 - \theta) \label{eq:eps_act}
\end{eqnarray}

\subsubsection{Pure non-Competitive Inhibition}
Next, we consider a pure non-competitive inhibitor with Hill coefficient $h$ and inhibition coefficient $K_I$:
\begin{eqnarray}
    \theta &=& 1 - \frac{x^h}{K_I^h + x^h} = \frac{K_I^h}{K_I^h + x^h}
\end{eqnarray}

The following plot shows the response of $\theta$ to the concentration $x$ in log-log scale.

\begin{center}
\begin{tikzpicture}
	\begin{loglogaxis}[width=200pt,axis x line=bottom, axis y line=left, tick align=outside, domain=1e-2:1e3, xlabel=$x/K_I$, ylabel=$\theta$ (relative activity)]
		\addplot+[mark=none,smooth] (\x,{(1 - (\x/(1+\x))});
		\addplot+[mark=none,smooth] (\x,{(1 - (\x^2/(1+\x^2))});
		\addplot+[mark=none,smooth] (\x,{(1 - (\x^3/(1+\x^3))});
		\end{loglogaxis}
	\node[rotate=-35] at (4.1, 3.2) {h = 1};
	\node[rotate=-55] at (4.2, 1.5) {h = 2};
	\node[rotate=-70] at (3.2, 1) {h = 3};
\end{tikzpicture}
\end{center}

In this case, the elasticity with regards to the inhibitor concentration would be:
\begin{eqnarray}
    \epsilon_x^v &=& \frac{\partial v}{\partial x}\cdot\frac{x}{v} = V^+ ~ \kappa ~ \gamma ~ \frac{- h ~ x^{h-1}}{(K_I^h + x^h)^2} ~ \frac{x}{v} \nonumber \\
    &=& -\frac{h ~ x^h ~ (K_I^h + x^h)}{(K_I^h + x^h)^2} = -h ~ \frac{x^h}{K_I^h + x^h} = -h (1 - \theta)~. \label{eq:eps_inh}
\end{eqnarray}

Plotting the elasticity as a function of $x$, we see that it is a monotonically decreasing negative function:

\begin{center}
\begin{tikzpicture}
	\begin{semilogxaxis}[width=200pt,axis x line=bottom, axis y line=left, tick align=outside, domain=1e-2:1e2, xlabel=$x/K_I$, ylabel=$\epsilon_x^v$]
		\addplot+[mark=none,smooth] (\x,{-1 * (\x/(1+\x))});		\addplot+[mark=none,smooth] (\x,{-2 * (\x^2/(1+\x^2))});		\addplot+[mark=none,smooth] (\x,{-3 * (\x^3/(1+\x^3))});
	\node[rotate=1] at (10, -0.6) {h = 1};
	\node[rotate=1] at (10, -1.7) {h = 2};
	\node[rotate=1] at (10, -2.7) {h = 3};
	\end{semilogxaxis}
\end{tikzpicture}
\end{center}

This means that substrates have the most control ($|\epsilon_s^v| \rightarrow 1$) when they are much below saturation ($s \ll K_M$) while inhibitors have the most control ($|\epsilon_x^v| \rightarrow h$) when they are saturated ($x \gg K_I$).


\subsubsection{Competitive Inhibition}
Competitive inhibition is one case, where a separable kinetic rate law is not sufficient since $\frac{\partial \kappa}{\partial x} \neq 0$. To analyze this case, we pick a simple one-substrate irreversible reaction, where the inhibitor affects the $K_M$ according to the following formula:
\begin{eqnarray}
    v &=& V^+ ~ \frac{s}{K_M \left(1 + \frac{x^h}{K_I^h}\right) + s}
\end{eqnarray}
In this case, we can define an \emph{effective} inhibition constants $K_{IC}$, that will allow us to rewrite this rate law in a form identical to non-competitive inhibition:
\begin{eqnarray}
    K_{IC} &\equiv& K_I \sqrt[h]{\frac{K_M + s}{K_M}} \nonumber\\
    v &=& V^+ ~ \frac{s}{K_M \left(1 + \frac{x^h}{K_I^h}\right) + s} =
          V^+ ~ \frac{s}{K_M \left(1 + \frac{x^h~(K_M + s)}{K_{IC}^h~K_M}\right) + s} = \nonumber\\
      &=& V^+ ~ \frac{s}{K_M + s + \frac{x^h~(K_M + s)}{K_{IC}^h}} = 
          V^+ ~ \frac{s}{K_M + s} \cdot \frac{1}{1 + \frac{x^h}{K_{IC}^h}} \label{eq:eps_comp_inh}
\end{eqnarray}
so we can see here that in this case $\theta = \frac{K_{IC}^h}{K_{IC}^h~+~x^h}$, exactly like in the case of non-competitive inhibition. Of course, the difference here is that $K_{IC}$ is not a binding constant but rather a function of $s$, $K_M$, and $K_I$. Nevertheless, we can use the same formula for the elasticity (since $K_{IC}$ is a constant with regards to $x$):
\begin{eqnarray}
    \epsilon_x^v &=& \frac{\partial v}{\partial x}~\frac{x}{v} = -h(1 - \theta)
\end{eqnarray}

\subsubsection{Uncompetitive Inhibition}
Uncompetitive inhibition is another case where substrate and inhibitor saturations are entangled:
\begin{eqnarray}
    v &=& V^+ ~ \frac{s}{K_M + s \left(1 + \frac{x^h}{K_I^h}\right)}
\end{eqnarray}
However, the same procedure as in competitive inhibition can also be used here, by defining an effective constant $K_{IU}$, that will allow us to rewrite this rate law in a form identical to non-competitive inhibition:
\begin{eqnarray}
    K_{IU} &\equiv& K_I \sqrt[h]{\frac{K_M + s}{s}} \nonumber\\
    v &=& V^+ ~ \frac{s}{K_M + s \left(1 + \frac{x^h}{K_I^h}\right)} =
          V^+ ~ \frac{s}{K_M + s \left(1 + \frac{x^h~(K_M + s)}{K_{IU}^h~s}\right)} = \nonumber\\
      &=& V^+ ~ \frac{s}{K_M + s + \frac{x^h~(K_M + s)}{K_{IU}^h}} = 
          V^+ ~ \frac{s}{K_M + s} \cdot \frac{1}{1 + \frac{x^h}{K_{IU}^h}}
\end{eqnarray}
which shows that just like in the case of competitive inhibition, $\theta = \frac{K_{IU}^h}{K_{IU}^h~+~x^h}$, and the formula for elasticity remains
\begin{eqnarray}
    \epsilon_x^v = -h(1 - \theta)\,. \label{eq:eps_uncomp_inh}
\end{eqnarray}

\subsubsection{Generalized Inhibition Model}
A general formula for reversible reactions with non-cooperative competitive, uncompetitive, mixed and pure non-competitive inhibition is given in Chapter 5 of \citet{Sauro2011-op}:
\begin{eqnarray}
    v &=& \frac{\frac{V_m}{K_S}\left(s - \frac{p}{K_{eq}}\right)\left(1 + b \frac{x}{aK_I}\right)}{\left(1 + \frac{s}{K_S} + \frac{p}{K_P}\right) + \frac{x}{K_I} \left(1 + \frac{s}{aK_S} + \frac{p}{aK_P}\right)}\,.
\end{eqnarray}
The parameter $b$ represents the amount of inhibition, i.e. the activity of the enzyme when the inhibitor is bound to it. If we assume there is no activity in the bound state, also known as \textbf{complete inhibition}, then we can set $b = 0$. 
Then, depending on the value of $a$, the above formula converges to the different cases discussed earlier. For example, if $a \rightarrow \infty$, then this rate law is equivalent to competitive inhibition. When $a = 1$ it is equivalent to pure non-competitive inhibition. Finally, if $a \rightarrow 0$ (more precisely, when $K_I \gg a K_I$), it becomes uncompetitive inhibition.

The elasticity we get for this general form is:
\begin{eqnarray}
\epsilon_x^v &=& \frac{b \frac{x}{aK_I}}{1 + b \frac{x}{aK_I}} ~-~ \frac{\frac{x}{K_I} \left(1 + \frac{s}{aK_S} + \frac{p}{aK_P}\right)}{\left(1 + \frac{s}{K_S} + \frac{p}{K_P}\right) + \frac{x}{K_I} \left(1 + \frac{s}{aK_S} + \frac{p}{aK_P}\right)}
\end{eqnarray}
as with previous cases, we can define an effective $K_E$:
\begin{eqnarray}
    K_{E1} & \equiv & K_I ~ \frac{a}{b} \\
    K_{E2} & \equiv & K_I ~ \frac{1 + \frac{s}{K_S} + \frac{p}{K_P}}{1 + \frac{s}{aK_S} + \frac{P}{aK_P}}
\end{eqnarray}
and therefore that we get:
\begin{eqnarray}
v &=& \frac{\frac{V_m}{K_S}\left(s - \frac{p}{K_{eq}}\right)}{\left(1 + \frac{s}{K_S} + \frac{p}{K_P}\right)} \cdot \frac{1 + \frac{x}{K_{E1}}}{1 + \frac{x}{K_{E2}}} \nonumber \\
\epsilon_x^v &=& \frac{x}{K_{E1} + x} ~-~ \frac{x}{K_{E2} + x}
\end{eqnarray}
As expected, in all cases of complete inhibition ($b \rightarrow 0$ which means that $K_{E1} \rightarrow \infty$), we reach exactly the same conclusion as in the extreme cases, namely:
\begin{eqnarray}
\theta = \frac{1 + \frac{x}{K_{E1}}}{1 + \frac{x}{K_{E2}}} &\rightarrow& \frac{K_{E2}}{K_{E2} + x} \nonumber\\
\epsilon_x^v &\rightarrow& -(1 - \theta) \label{eq:eps_general_inh}
\end{eqnarray}

For incomplete inhibition, however, there is a more complex relationship between relative activity and inhibition.


\subsubsection{The Monod-Changeux-Jacob model}
Probably the most widespread model for cooperativity of substrate and effector binding was proposed by \citet{Monod1965-dq}. In this model the rate law is given by the following formula:
\begin{eqnarray}
v &=& V^+ \cdot \frac{s}{K_M + s} \cdot \frac{\left(1 + \frac{s}{K_M}\right)^h \left(1 + \frac{a}{K_A}\right)^h \left(1 + \frac{x}{K_I}\right)^{-h}}{L + \left(1 + \frac{s}{K_M}\right)^h \left(1 + \frac{a}{K_A}\right)^h \left(1 + \frac{x}{K_I}\right)^{-h}}
\end{eqnarray}
where $a$ is the concentration of an inhibitor, and $K_M$, $K_A$ and $K_I$ are the dissociation constants for the active form of the enzyme (for $s$, $a$ and $x$ respectively), $n$ is the number of subunits, and $L$ is the allosteric constant. As before, we can define the saturation term $\kappa$ and the relative activity term $\theta$ (i.e. the decrease from maximal activity):
\begin{eqnarray}
\kappa &\equiv& \frac{s}{K_M + s} \nonumber\\
\theta &\equiv& \frac{\left(1 + \frac{s}{K_M}\right)^h \left(1 + \frac{a}{K_A}\right)^h \left(1 + \frac{x}{K_I}\right)^{-h}}{L + \left(1 + \frac{s}{K_M}\right)^h \left(1 + \frac{a}{K_A}\right)^h \left(1 + \frac{x}{K_I}\right)^{-h}} \nonumber\\
v &=& V^+ \cdot \kappa \cdot \theta
\end{eqnarray}
In \cite{Heinrich1974-yj}, the elasticity of the inhibitor was calculated for this rate law (denoted as \emph{effector strength} or $X_I$ in the original text):
\begin{eqnarray}
\epsilon_x^v = \frac{\partial \ln{v}}{\partial \ln{x}} = \frac{\partial \ln{\theta}}{\partial \ln{x}} = - h~\frac{x}{K_I + x} ~\left(1 - \theta \right)\,.
\end{eqnarray}
Although the final formulae for the elasticities in the MWC case are not identical to the other cases dealt with before, we can still reach a similar conclusion, where the absolute value of the elasticity is larger when the relative activity is smaller.

\subsection{A Trade-off between Enzyme Cost and Flux Control}
By taking the absolute value of the elasticity, we can compress the results for activators (Equation \ref{eq:eps_act}) and inhibitors (Equations \ref{eq:eps_inh}, \ref{eq:eps_comp_inh}, \ref{eq:eps_uncomp_inh}, and \ref{eq:eps_general_inh}, excluding the MWC model) into one formula:
\begin{eqnarray}
|\epsilon_x^v| = h (1 - \theta)~. \label{eq:abs_elast}
\end{eqnarray}
This relationship can be visualized in the following plot (for different values of $h$):
\begin{center}
\begin{tikzpicture}[scale=1]
	\begin{axis}[width=200pt,axis x line=bottom, axis y line=left, tick align=outside, domain=0:1, xlabel=$\theta$ (relative activity), ylabel=$|\epsilon_x^v|$ (absolute elasticity)]
		\addplot+[mark=none,smooth] (\x,{1 * (1 - \x)});
		\addplot+[mark=none,smooth] (\x,{2 * (1 - \x)});
		\addplot+[mark=none,smooth] (\x,{3 * (1 - \x)});
	\end{axis}
	\node[rotate=-15] at (1.2, 1.4) {h = 1};
	\node[rotate=-29] at (1.2, 2.6) {h = 2};
	\node[rotate=-40] at (1.2, 3.8) {h = 3};
\end{tikzpicture}
\end{center}

Since $\theta$ represents the fraction of active enzyme, we see here that there is direct trade-off between the activity of the enzyme and the elasticity. It should be noted, that evolution can easily adjust $\theta$ for an individual enzyme by changing the $K_A$ or $K_I$ values, even without changing the concentration of the small-molecule effector (assuming it has other crucial functions in the cell). Therefore, evolution needs to weigh between how much of the enzyme is "wasted" by inhibition (or by inactivation), versus how much control it has on the flux. This can be viewed as a trade-off between the short-term goal of being able to adjust things quickly and the long-term goal of allocating resources efficiently in order to grow as fast as possible.

Another corollary of Equation \ref{eq:abs_elast} is that the control can be increased by changing the Hill coefficient ($h$). This could be a reason why mechanisms with very high cooperativity evolve for allosteric regulation \cite{Monod1965-dq}, as it increases elasticity without the added cost of losing enzyme activity.


\bibliographystyle{unsrtnat}
\bibliography{control_theory}

\end{document}